2025-03-12 14:30:45 - utils - INFO - Logging initialized. Log file: /Users/mrsmoothy/Desktop/rsidtrade/trading_/logs/rsidtrade_20250312_143044.log
2025-03-12 14:30:45 - __main__ - INFO - Starting AI Trading Bot Single Run
2025-03-12 14:30:45 - utils - INFO - System Information:
2025-03-12 14:30:45 - utils - INFO -   python_version: 3.10.16
2025-03-12 14:30:45 - utils - INFO -   system: Darwin
2025-03-12 14:30:45 - utils - INFO -   release: 24.3.0
2025-03-12 14:30:45 - utils - INFO -   processor: arm
2025-03-12 14:30:45 - utils - INFO -   cpu_count: 8
2025-03-12 14:30:45 - utils - INFO -   memory_total_gb: 8.0
2025-03-12 14:30:45 - utils - INFO -   tensorflow_version: 2.19.0
2025-03-12 14:30:45 - utils - INFO -   numpy_version: 2.1.3
2025-03-12 14:30:45 - utils - INFO -   pandas_version: 2.2.3
2025-03-12 14:30:45 - __main__ - INFO - Processing BTCUSDT 1h
2025-03-12 14:30:45 - __main__ - INFO - Loading data
2025-03-12 14:30:45 - data_processor - INFO - Loading data from /Users/mrsmoothy/Desktop/rsidtrade/binance_data_sets/BTCUSDT_1h_data_2021_to_2023.csv
2025-03-12 14:30:45 - data_processor - INFO - Loaded 21826 rows of data
2025-03-12 14:30:45 - __main__ - INFO - Generating features
2025-03-12 14:30:52 - __main__ - INFO - Starting model optimization
2025-03-12 14:30:52 - data_processor - INFO - Loading data from /Users/mrsmoothy/Desktop/rsidtrade/binance_data_sets/BTCUSDT_1h_data_2021_to_2023.csv
2025-03-12 14:30:52 - data_processor - INFO - Loaded 21826 rows of data
2025-03-12 14:30:59 - optimizer - INFO - Prepared 21721 sequences with 100 time steps and 36 features
2025-03-12 14:30:59 - model - INFO - Building lstm model with input shape (100, 36)
2025-03-12 14:30:59 - model - INFO - Training lstm model with 17377 samples
2025-03-12 14:31:01 - __main__ - ERROR - Error in single run: Graph execution error:

Detected at node compile_loss/huber_loss/Sub defined at (most recent call last):
  File "/Users/mrsmoothy/Desktop/rsidtrade/trading_/run_single.py", line 829, in <module>

  File "/Users/mrsmoothy/Desktop/rsidtrade/trading_/run_single.py", line 607, in main

  File "/Users/mrsmoothy/Desktop/rsidtrade/trading_/run_single.py", line 185, in perform_model_optimization

  File "/Users/mrsmoothy/Desktop/rsidtrade/trading_/optimizer.py", line 196, in optimize

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/optuna/study/_optimize.py", line 63, in _optimize

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial

  File "/Users/mrsmoothy/Desktop/rsidtrade/trading_/optimizer.py", line 150, in objective

  File "/Users/mrsmoothy/Desktop/rsidtrade/trading_/model.py", line 362, in train

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 371, in fit

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 219, in function

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 132, in multi_step_on_iterator

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 113, in one_step_on_data

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 60, in train_step

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/trainers/trainer.py", line 383, in _compute_loss

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/trainers/trainer.py", line 351, in compute_loss

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/trainers/compile_utils.py", line 690, in __call__

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/trainers/compile_utils.py", line 699, in call

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/losses/loss.py", line 67, in __call__

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/losses/losses.py", line 33, in call

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/losses/losses.py", line 1889, in huber

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/ops/numpy.py", line 6078, in subtract

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/sparse.py", line 493, in sparse_wrapper

  File "/Users/mrsmoothy/miniforge3/envs/rsidtrade/lib/python3.10/site-packages/keras/src/backend/tensorflow/numpy.py", line 439, in subtract

Incompatible shapes: [97,100,5] vs. [97,5]
	 [[{{node compile_loss/huber_loss/Sub}}]] [Op:__inference_multi_step_on_iterator_3801]
